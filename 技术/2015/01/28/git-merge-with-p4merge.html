<!DOCTYPE html> <html class='borderbox'> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>使用 P4Merge 作为 GIT 的可视化合并工具</title> <meta name="description" content="这是我的中文博客，记录自己在技术、生活等方面的一些感想。博客叫 Storm Spirit， 因为我特别喜欢 Dota 里蓝猫这个英雄，可惜玩得不好…… 希望自己能够通过博客，得到成长。 "> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://wwulfric.github.io/%E6%8A%80%E6%9C%AF/2015/01/28/git-merge-with-p4merge.html"> <script src="/js/jquery-2.1.1.min.js"></script> <script src="/js/jquery.modal.min.js"></script> <script src="/js/main.js"></script> </head> <body> <div class='content'> <header> <a class="site-title" href="/">Storm Spirit</a> </header> <div class="post typo"> <header class="post-header clearfix"> <div class='date pull-left clearfix'> <div class='day-month pull-left'> <div class='day'>28</div> <div class='month'>JAN</div> </div> <div class='year pull-left'>2015</div> </div> <h1 class="post-title">使用 P4Merge 作为 GIT 的可视化合并工具</h1> </header> <blockquote id='by-nc-nd'> 声明: 本文采用 <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh_TW" rel="nofollow" target="_blank" title="姓名标示-非商业性-禁止改作4.0国际">CC BY-NC-ND 4.0</a> 授权。 </blockquote> <article class="post-content"> <p>P4Merge 是一款非常优秀的 git merge 工具，且跨平台兼容。尽管 git 亦有内部实现的 merge 工具，但并不如 P4Merge 易用。我们可以通过配置<code>.gitconfig</code>文件来设置 git 使用外部 merge 工具。</p> <p><figure> <a class='post-image' rel='post-image' href='http://www.perforce.com/sites/default/files/p4merge_three_pane_1.jpg'> <img src="http://www.perforce.com/sites/default/files/p4merge_three_pane_1.jpg" alt="P4Merge" /> </a> <figcaption>P4Merge</figcaption> </figure></p> <p>首先，下载安装 <a href="http://www.perforce.com/product/components/perforce-visual-merge-and-diff-tools">P4Merge</a>。MAC 下可以通过<code>brew cask install p4merge</code>来安装。</p> <p>在系统可访问的目录下（我们这里使用<code>/usr/local/bin/</code>）创建两个可执行文件<code>extMerge</code>和<code>extDiff</code>，其内容如下。</p> <div class="highlight"><pre><code class="language-bash">$ cat /usr/local/bin/extMerge
<span class="c1">#!/bin/sh</span>
/Applications/p4merge.app/Contents/MacOS/p4merge <span class="nv">$*</span></code></pre></div> <div class="highlight"><pre><code class="language-bash">$ cat /usr/local/bin/extDiff
<span class="c1">#!/bin/sh</span>
<span class="o">[</span> <span class="nv">$#</span> -eq <span class="m">7</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> /usr/local/bin/extMerge <span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$5</span><span class="s2">&quot;</span></code></pre></div> <p>别忘了添加可执行权限：</p> <div class="highlight"><pre><code class="language-bash">$ sudo chmod +x /usr/local/bin/extMerge
$ sudo chmod +x /usr/local/bin/extDiff</code></pre></div> <p>使用 <code>extMerge</code>和<code>extDiff</code>的好处是，我们可以很方便的切换 merge 工具。</p> <p>最后，在你的<code>.gitconfig</code>文件里添加如下配置：</p> <div class="highlight"><pre><code class="language-bash"><span class="o">[</span>merge<span class="o">]</span>
    <span class="nv">tool</span> <span class="o">=</span> extMerge
<span class="o">[</span>mergetool <span class="s2">&quot;extMerge&quot;</span><span class="o">]</span>
    <span class="nv">cmd</span> <span class="o">=</span> extMerge <span class="s2">&quot;</span><span class="nv">$BASE</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$LOCAL</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$REMOTE</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$MERGED</span><span class="s2">&quot;</span>
<span class="o">[</span>diff<span class="o">]</span>
    <span class="nv">external</span> <span class="o">=</span> extDiff
<span class="o">[</span>mergetool<span class="o">]</span>
    <span class="nv">trustExitCode</span> <span class="o">=</span> <span class="nb">false</span>
    <span class="nv">keepTemporaries</span> <span class="o">=</span> <span class="nb">false</span>
    <span class="nv">keepBackup</span> <span class="o">=</span> <span class="nb">false</span>
    <span class="nv">prompt</span> <span class="o">=</span> <span class="nb">false</span></code></pre></div> <p>好了，当合并（merge/rebase） 出现冲突时，执行<code>git mergetool</code>，即可调出 P4Merge 来解决冲突了。唯一的缺点是，目前还不支持 Retina 屏，看起来有些糊。(PS：可以用工具<a href="http://retinizer.mikelpr.com/">Retinizer</a>来解决这一问题)</p> <p>更多细节参见官网<a href="http://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration#External-Merge-and-Diff-Tools">链接</a>。</p> </article> <div id='additional' class='clearfix'> <div id="tags" class='pull-left'> P4Merge, git, merge </div> <a class='pull-right' href="#comments" rel="modal:open">评论</a> </div> <div id="comments"> <!-- 多说评论框 start --> <div class="ds-thread" data-thread-key="/%E6%8A%80%E6%9C%AF/2015/01/28/git-merge-with-p4merge.html" data-title="使用 P4Merge 作为 GIT 的可视化合并工具" data-url="http://wwulfric.github.io/%E6%8A%80%E6%9C%AF/2015/01/28/git-merge-with-p4merge.html"></div> <!-- 多说评论框 end --> <!-- 多说公共JS代码 start (一个网页只需插入一次) --> <script type="text/javascript"> var duoshuoQuery = {short_name:"storm-spirit"}; (function() { var ds = document.createElement('script'); ds.type = 'text/javascript';ds.async = true; ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js'; ds.charset = 'UTF-8'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds); })(); </script> <!-- 多说公共JS代码 end --> </div> </div> <footer> <a class="page-link" href="/about/">wulfric</a> © 2013~2014. All rights reserved. </footer> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-54608037-1', 'auto'); ga('send', 'pageview'); </script> </div> </body> </html>
