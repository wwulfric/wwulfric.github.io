<!DOCTYPE html> <html class='borderbox'> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Homebrew--MAC下包管理工具和软件安装工具</title> <meta name="description" content="这是我的中文博客，记录自己在技术、生活等方面的一些感想。博客叫 Storm Spirit， 因为我特别喜欢 Dota 里蓝猫这个英雄，可惜玩得不好…… 希望自己能够通过博客，得到成长。 "> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://wwulfric.github.io/%E6%8A%80%E6%9C%AF/2015/08/11/homebrew.html"> <script src="/js/jquery-2.1.1.min.js"></script> <script src="/js/jquery.modal.min.js"></script> <script src="/js/main.js"></script> </head> <body> <div class='content'> <header> <a class="site-title" href="/">Storm Spirit</a> </header> <div class="post typo"> <header class="post-header clearfix"> <div class='date pull-left clearfix'> <div class='day-month pull-left'> <div class='day'>11</div> <div class='month'>AUG</div> </div> <div class='year pull-left'>2015</div> </div> <h1 class="post-title">Homebrew--MAC下包管理工具和软件安装工具</h1> </header> <blockquote id='by-nc-nd'> 声明: 本文采用 <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh_TW" rel="nofollow" target="_blank" title="姓名标示-非商业性-禁止改作4.0国际">CC BY-NC-ND 4.0</a> 授权。 </blockquote> <article class="post-content"> <h2 id="homebrew">Homebrew</h2> <p><a href="http://brew.sh/">Homebrew</a> 是MAC下的包管理工具，可以当做<code>debian</code>下的<code>apt-get</code>，但要强大得多。它尽可能的利用系统自带库，大大缩短编译时间；冗余库极少，软件包的管理清晰灵活；安装脚本完全用<code>ruby</code>编写，极易自由定制<sup id="fnref:linfan"><a href="#fn:linfan" class="footnote">1</a></sup>。</p> <p>一键安装（一键脚本请参照官网，可能略有不同）：</p> <div class="highlight"><pre><code class="language-bash">ruby -e <span class="s2">&quot;</span><span class="k">$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="k">)</span><span class="s2">&quot;</span></code></pre></div> <p>安装完毕后执行<code>brew</code>，输出如下，列出了 brew 的一些用法。</p> <div class="highlight"><pre><code class="language-bash">&gt; brew
Example usage:
  brew <span class="o">[</span>info <span class="p">|</span> home <span class="p">|</span> options <span class="o">]</span> <span class="o">[</span>FORMULA...<span class="o">]</span>
  brew install FORMULA...
  brew uninstall FORMULA...
  brew search <span class="o">[</span>foo<span class="o">]</span>
  brew list <span class="o">[</span>FORMULA...<span class="o">]</span>
  brew update
  brew upgrade <span class="o">[</span>FORMULA...<span class="o">]</span>
  brew pin/unpin <span class="o">[</span>FORMULA...<span class="o">]</span>

Troubleshooting:
  brew doctor
  brew install -vd FORMULA
  brew <span class="o">[</span>--env <span class="p">|</span> config<span class="o">]</span>

Brewing:
  brew create <span class="o">[</span>URL <span class="o">[</span>--no-fetch<span class="o">]]</span>
  brew edit <span class="o">[</span>FORMULA...<span class="o">]</span>
  https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/Formula-Cookbook.md

Further help:
  man brew
  brew home</code></pre></div> <p>可以方便的搜索、查看和安装和卸载软件，如下图所示：</p> <p><figure> <a class='post-image' rel='post-image' href='http://wulfric.qiniudn.com/brew-action.png'> <img src="http://wulfric.qiniudn.com/brew-action.png" alt="brew actions" title="brew actions" /> </a> <figcaption>brew actions</figcaption> </figure></p> <p>按照官方的介绍：</p> <ul> <li>Homebrew installs <a href="https://github.com/Homebrew/homebrew/tree/master/Library/Formula">the stuff you need</a> that Apple didn’t. 是MAC OS生态的重要补充，提供了大量在Linux下喜闻乐见的工具，比如<code>curl</code>, <code>rename</code>, <code>wget</code>等等；</li> <li>Homebrew installs packages to their own directory and then symlinks their files into <code>/usr/local</code>. 通过 brew 安装的软件可以和系统原软件完美兼容，互不影响；</li> <li>Homebrew won’t install files outside its prefix, and you can place a Homebrew installation wherever you like. homebrew 安装的文件默认全部在其指定的目录下，不会安装在其他位置。方便删除，可以自定义 homebrew 的安装位置；</li> <li>Trivially create your own Homebrew packages. 方便的创建个人包；</li> <li>It’s all git and ruby underneath, so hack away with the knowledge that you can easily revert your modifications and merge upstream updates. 通过git管理所有安装配置，极易创建「私服」，把官方repo作为上游分支，可以自由定制。</li> </ul> <div class="highlight"><pre><code class="language-ruby"><span class="c1"># brew edit wget 可以直接编辑wget的安装配置</span>
<span class="k">class</span> <span class="nc">Wget</span> <span class="o">&lt;</span> <span class="no">Formula</span>
  <span class="n">homepage</span> <span class="s2">&quot;https://www.gnu.org/software/wget/&quot;</span>
  <span class="n">url</span> <span class="s2">&quot;https://ftp.gnu.org/gnu/wget/wget-1.15.tar.gz&quot;</span>
  <span class="n">sha256</span> <span class="s2">&quot;52126be8cf1bddd7536886e74c053ad7d0ed2aa89b4b630f76785bac21695fcd&quot;</span>

  <span class="k">def</span> <span class="nf">install</span>
    <span class="nb">system</span> <span class="s2">&quot;./configure&quot;</span><span class="p">,</span> <span class="s2">&quot;--prefix=</span><span class="si">#{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="nb">system</span> <span class="s2">&quot;make&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div> <p>我安装的软件有：</p> <div class="highlight"><pre><code class="language-bash">&gt; brew list <span class="p">|</span> paste -sd <span class="s1">&#39;,&#39;</span> -
aspell,autoconf,autojump,automake,bash,boris,brew-cask,ccat,cloog,cmake,composer,coreutils,cscope,ctags,editorconfig,emacs-clang-complete-async,emacs-mac,fontconfig,freetype,gcc,gdbm,gettext,git,gmp,gnu-sed,gnutls,go,htop-osx,icu4c,imagemagick,isl,jpeg,leptonica,libevent,libmpc,libpng,libtasn1,libtiff,libtool,llvm,mercurial,mobile-shell,mpfr,nettle,newt,nvm,openssl,pcre,php56,pkg-config,popt,protobuf,proxychains-ng,pyenv,pyqt,python,qt,rbenv,rbenv-gem-rehash,readline,rename,ruby-build,s-lang,sip,sqlite,tesseract,the_silver_searcher,tig,tree,unixodbc,vim,wget,xz,zeromq,zlib,zsh</code></pre></div> <p>PS: 当希望用 brew 安装的软件替代系统自带的软件（比如 git）时，确保<code>$PATH</code>中 brew 安装的位置在系统位置<code>/usr/bin</code>之前，可以运行<code>brew doctor</code>查看。安装软件完成之后请查看安装成功的一些后续指导。</p> <p>PS: 执行<code>brew cleanup</code>清除安装产生的缓存文件。</p> <p>PS: 使用 <a href="https://github.com/jimbojsb/launchrocket">LaunchRocket</a> 管理 brew 安装的 service。</p> <h2 id="homebrew-cask">Homebrew Cask</h2> <p><a href="http://caskroom.io/">caskroom</a>(brew cask) 构建于 Homebrew，继承了其优雅和便捷性，提供安装 OS X 应用和二进制软件的新方法。可以这么简单理解，brew安装的是命令行工具，比如<code>curl</code>, <code>rename</code>, <code>wget</code>；brew cask安装的是应用软件，比如<code>google chrome</code>, <code>dropbox</code>等。通过brew cask 安装软件，只需要简单的一条命令<code>brew cask install google-chrome</code>即可，再也不需要以前的打开网页、找到链接、下载软件、解压包、放到程序目录，删除安装文件，再来启动它这么复杂的步骤了。一键完成！<sup id="fnref:yangzhiping"><a href="#fn:yangzhiping" class="footnote">2</a></sup></p> <p>虽然通过 Mac App Store 安装软件一样很简单，但是 Mac App Store 生态圈远不完善，审核流程过长，限制太多，维护成本过高让很多应用开发者被迫离开。大量软件缺失。<sup id="fnref:ksmx"><a href="#fn:ksmx" class="footnote">3</a></sup></p> <p>安装<code>brew install caskroom/cask/brew-cask</code>，安装完毕后执行<code>brew cask</code>，可以看到 cask 提供的命令基本上继承自 brew：</p> <div class="highlight"><pre><code class="language-bash">&gt; brew cask
brew-cask provides a friendly homebrew-style CLI workflow <span class="k">for</span> the
administration of Mac applications distributed as binaries.

!!
!! no <span class="nb">command</span> verb:
!!

Commands:

    alfred     displays note about new built-in alfred support
    audit      verifies installability of Casks
    cat        dump raw <span class="nb">source</span> of the given Cask to the standard output
    cleanup    cleans up cached downloads and tracker symlinks
    create     creates the given Cask and opens it in an editor
    doctor     checks <span class="k">for</span> configuration issues
    edit       edits the given Cask
    fetch      downloads Cask resources to <span class="nb">local</span> cache
    home       opens the homepage of the given Cask
    info       displays information about the given Cask
    install    installs the given Cask
    list       with no args, lists installed Casks<span class="p">;</span> given installed Casks, lists staged files
    search     searches all known Casks
    uninstall  uninstalls the given Cask
    update     a synonym <span class="k">for</span> <span class="s1">&#39;brew update&#39;</span>
    zap        zaps all files associated with the given Cask

See also <span class="s2">&quot;man brew-cask&quot;</span></code></pre></div> <p>通过 brew 安装的软件都在<code>/opt/homebrew-cask/Caskroom</code>下：</p> <div class="highlight"><pre><code class="language-bash">&gt; <span class="nb">cd</span> /opt/homebrew-cask/Caskroom

/opt/homebrew-cask/Caskroom
&gt; ls
aliwangwang      goagentx         macdown          sourcetree       virtualbox
anki             google-chrome    mplayerx         thunder          xiami
bettertouchtool  haskell-platform p4merge          tunnelblick      xtrafinder
dropbox          iterm2           qqinput          typora           zotero
evernote         jumpcut          rdm              utopia
firefox          lilypond         skitch           vagrant</code></pre></div> <p>同时在<code>~/Applications</code>下创建了链接文件：</p> <div class="highlight"><pre><code class="language-bash">&gt; ll ~/Applications
lrwxr-xr-x  <span class="m">1</span> haidao  staff    62B Jun <span class="m">13</span>  <span class="m">2014</span> AliWangwang.app -&gt; /opt/homebrew-cask/Caskroom/aliwangwang/latest/AliWangwang.app
...</code></pre></div> <p>你也可以像 brew 那样自由定制，假如你觉得某个软件全球的用户都需要，就可以向官方 repo 发起 pull request。</p> <div class="highlight"><pre><code class="language-ruby"><span class="n">cask</span> <span class="ss">:v1</span> <span class="o">=&gt;</span> <span class="s1">&#39;dropbox&#39;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="ss">:latest</span>
  <span class="n">sha256</span> <span class="ss">:no_check</span>

  <span class="n">url</span> <span class="s1">&#39;https://www.dropbox.com/download?plat=mac&amp;full=1&#39;</span>
  <span class="nb">name</span> <span class="s1">&#39;Dropbox&#39;</span>
  <span class="n">homepage</span> <span class="s1">&#39;https://www.dropbox.com/&#39;</span>
  <span class="n">license</span> <span class="ss">:gratis</span>

  <span class="n">app</span> <span class="s1">&#39;Dropbox.app&#39;</span>

  <span class="n">zap</span> <span class="ss">:delete</span> <span class="o">=&gt;</span> <span class="s1">&#39;~/.dropbox&#39;</span>
<span class="k">end</span></code></pre></div> <p>更有趣的是，你的重装系统将变得极为简单！把你的常用软件列表记下来，然后执行<code>brew cask install software-1 software-2 ... software-n</code>，然后睡一觉就一切搞定了~ 个人文档数据通过<code>dropbox</code>直接恢复~你的代码肯定都在 github~</p> <p>PS: cask 重装软件，<code>brew cask uninstall xxx &amp;&amp; brew cask install xxx</code>或<code>brew cask install xxx --force</code>。</p> <p>PS: alfred 支持，<code>brew cask alfred link</code>。</p> <p>PS: brew 和 brew cask 的下载都是断点续传的。</p> <div class="footnotes"> <ol> <li id="fn:linfan"> <p><a href="http://linfan.info/blog/2012/02/25/homebrew-installation-and-usage/">Homebrew的安装与使用</a>&nbsp;<a href="#fnref:linfan" class="reversefootnote">&#8617;</a></p> </li> <li id="fn:yangzhiping"> <p><a href="http://www.yangzhiping.com/tech/homebrew-cask.html">Mac安装软件新方法：Homebrew-cask</a>&nbsp;<a href="#fnref:yangzhiping" class="reversefootnote">&#8617;</a></p> </li> <li id="fn:ksmx"> <p><a href="http://ksmx.me/homebrew-cask-cli-workflow-to-install-mac-applications/">简洁优雅的Mac OS X软件安装体验 - homebrew-cask</a>&nbsp;<a href="#fnref:ksmx" class="reversefootnote">&#8617;</a></p> </li> </ol> </div> </article> <div id='additional' class='clearfix'> <div id="tags" class='pull-left'> homebrew, brew, brew cask, mac </div> <a class='pull-right' href="#comments" rel="modal:open">评论</a> </div> <div id="comments"> <!-- 多说评论框 start --> <div class="ds-thread" data-thread-key="/%E6%8A%80%E6%9C%AF/2015/08/11/homebrew.html" data-title="Homebrew--MAC下包管理工具和软件安装工具" data-url="http://wwulfric.github.io/%E6%8A%80%E6%9C%AF/2015/08/11/homebrew.html"></div> <!-- 多说评论框 end --> <!-- 多说公共JS代码 start (一个网页只需插入一次) --> <script type="text/javascript"> var duoshuoQuery = {short_name:"storm-spirit"}; (function() { var ds = document.createElement('script'); ds.type = 'text/javascript';ds.async = true; ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js'; ds.charset = 'UTF-8'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds); })(); </script> <!-- 多说公共JS代码 end --> </div> </div> <footer> <a class="page-link" href="/about/">wulfric</a> © 2013~2014. All rights reserved. </footer> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-54608037-1', 'auto'); ga('send', 'pageview'); </script> </div> </body> </html>
