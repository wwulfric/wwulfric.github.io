<!DOCTYPE html> <html class='borderbox'> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>一些命令行效率工具</title> <meta name="description" content="这是我的中文博客，记录自己在技术、生活等方面的一些感想。博客叫 Storm Spirit， 因为我特别喜欢 Dota 里蓝猫这个英雄，可惜玩得不好…… 希望自己能够通过博客，得到成长。 "> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://wwulfric.github.io/%E6%8A%80%E6%9C%AF/2015/08/13/zsh.html"> <script src="/js/jquery-2.1.1.min.js"></script> <script src="/js/jquery.modal.min.js"></script> <script src="/js/main.js"></script> </head> <body> <div class='content'> <header> <a class="site-title" href="/">Storm Spirit</a> </header> <div class="post typo"> <header class="post-header clearfix"> <div class='date pull-left clearfix'> <div class='day-month pull-left'> <div class='day'>13</div> <div class='month'>AUG</div> </div> <div class='year pull-left'>2015</div> </div> <h1 class="post-title">一些命令行效率工具</h1> </header> <blockquote id='by-nc-nd'> 声明: 本文采用 <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh_TW" rel="nofollow" target="_blank" title="姓名标示-非商业性-禁止改作4.0国际">CC BY-NC-ND 4.0</a> 授权。 </blockquote> <article class="post-content"> <h2 id="zsh">Zsh</h2> <p>Zsh 也许是目前最好用的 shell，是 bash 替代品中较为优秀的一个。这里列举了 zsh 的一些优点：<a href="https://www-s.acm.illinois.edu/workshops/zsh/why.html">为什么要使用 zsh</a>。</p> <p>Mac 自带 zsh，不过我们当然要用最新版啦，其他发行版请参照各自的软件安装方法。安装完毕后，重新打开 iTerm2。</p> <div class="highlight"><pre><code class="language-bash">brew install zsh
chsh -s <span class="sb">`</span>which zsh<span class="sb">`</span></code></pre></div> <h3 id="补全">补全</h3> <p>zsh 的命令补全功能非常强大，可以补齐路径，补齐命令，补齐参数等。（请问你记住 tar 的所有参数了吗😃，只要 <code>tar -</code>加 tab 键，再也不用 <a href="https://zh.wikipedia.org/zh/RTFM">rtfm</a> 了😂）</p> <p><figure> <a class='post-image' rel='post-image' href='http://wulfric.qiniudn.com/R-zsh-autocomplete.png'> <img src="http://wulfric.qiniudn.com/R-zsh-autocomplete.png" alt="zsh auto complete" title="zsh auto complete" /> </a> <figcaption>zsh auto complete</figcaption> </figure></p> <p>按下 tab 键显示出所有待选项后，再按一次 tab 键，即进入选择模式，进入选择模式后，按 tab 切向下一个选项，按 shift+tab 键切向上一个选项，ctrl+f/b/n/p 可以向前后左右切换。</p> <p><figure> <a class='post-image' rel='post-image' href='http://wulfric.qiniudn.com/R-zsh-tab-tab.png'> <img src="http://wulfric.qiniudn.com/R-zsh-tab-tab.png" alt="zsh tab 切换" title="zsh tab 切换" /> </a> <figcaption>zsh tab 切换</figcaption> </figure></p> <p>以前杀进程是<code>ps aux | grep xxx</code>查进程的 PID，然后<code>kill PID</code>。有了 zsh，直接<code>kill xxx</code>然后按下 tab 键即可～</p> <div class="highlight"><pre><code class="language-bash"><span class="nb">kill</span> emacs
<span class="c1"># 按下 tab，变成：</span>
<span class="nb">kill</span> <span class="m">59683</span></code></pre></div> <h3 id="别名">别名</h3> <p>zsh 不仅支持普通 alias，还支持针对文件类型的 alias。我配置的文件类型 alias 如下：</p> <div class="highlight"><pre><code class="language-bash"><span class="nb">alias</span> -s <span class="nv">gz</span><span class="o">=</span><span class="s1">&#39;tar -xzvf&#39;</span>
<span class="nb">alias</span> -s <span class="nv">tgz</span><span class="o">=</span><span class="s1">&#39;tar -xzvf&#39;</span>
<span class="nb">alias</span> -s <span class="nv">zip</span><span class="o">=</span><span class="s1">&#39;unzip&#39;</span>
<span class="nb">alias</span> -s <span class="nv">bz2</span><span class="o">=</span><span class="s1">&#39;tar -xjvf&#39;</span>
<span class="nb">alias</span> -s <span class="nv">php</span><span class="o">=</span>vi
<span class="nb">alias</span> -s <span class="nv">py</span><span class="o">=</span>vi
<span class="nb">alias</span> -s <span class="nv">rb</span><span class="o">=</span>vi
<span class="nb">alias</span> -s <span class="nv">html</span><span class="o">=</span>vi
<span class="nb">alias</span> <span class="nv">gcid</span><span class="o">=</span><span class="s2">&quot;git log | head -1 | awk &#39;{print substr(\$2,1,7)}&#39; | pbcopy&quot;</span></code></pre></div> <p>配置完毕之后，在 zsh 下直接输入<code>xxx.rb</code>，将自动用 vi 打开，直接输入<code>xxx.tgz</code>，将直接按照<code>tar -xzvf</code>解压。最后一个<code>gcid</code>将当前 git 项目的第一个 commit 的 id 复制到系统剪切板（<code>pbcopy</code>是 Mac 下的复制到系统剪切板命令，linux 请参考相应的发行版更改），在执行 rebase 的时候特别方便。</p> <h3 id="跳转">跳转</h3> <p>zsh 的目录跳转更为智能，你无需输入<code>cd</code>，直接输入路径即可。<code>..</code>表示后退一级目录，<code>../../</code>表示后退两级，依次类推。（<code>...</code>的作用和<code>../../</code>相同）</p> <p>输入<code>d</code>，将列出当前 session 访问过的所有目录，再按提示的数字即可进入相应目录。</p> <div class="highlight"><pre><code class="language-bash">~
&gt; d
<span class="m">0</span>	~
<span class="m">1</span>	~/Applications
<span class="m">2</span>	~/.proxychains
<span class="m">3</span>	/opt/homebrew-cask/Caskroom

~
&gt; <span class="m">1</span>
~/Applications</code></pre></div> <h3 id="历史记录">历史记录</h3> <p>zsh 的历史记录跨 session，可以共享。历史记录支持受限查找。比如，输入<code>git</code>，再按向上箭头，会搜索用过的所有 git 命令。</p> <h3 id="通配符搜索">通配符搜索</h3> <p><code>ls *.png</code>查找当前目录下所有 png 文件，<code>ls **/*.png</code>递归查找。</p> <h2 id="oh-my-zsh">oh-my-zsh</h2> <p><a href="https://github.com/robbyrussell/oh-my-zsh">oh-my-zsh</a> 是最为流行的 zsh 配置文件，提供了大量的主题和插件，极大的拓展了 zsh 的功能，推动了 zsh 的流行，有点类似于 rails 之于 ruby。</p> <div class="highlight"><pre><code class="language-bash"><span class="c1"># install</span>
<span class="c1"># via curl</span>
sh -c <span class="s2">&quot;</span><span class="k">$(</span>curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh<span class="k">)</span><span class="s2">&quot;</span>
<span class="c1"># via wget </span>
sh -c <span class="s2">&quot;</span><span class="k">$(</span>wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -<span class="k">)</span><span class="s2">&quot;</span></code></pre></div> <p>安装过后，<code>source ~/.zshrc</code>使之生效。</p> <h3 id="主题">主题</h3> <p>oh-my-zsh 内置了大量主题，可在<code>~/.oh-my-zsh/themes</code>中查看具体的配置。官网提供了一些主题的<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/themes">截图</a>。也可参见我的<a href="http://www.zhihu.com/question/33277508/answer/58979821">知乎回答</a>。</p> <div class="highlight"><pre><code class="language-bash"><span class="c1"># 我用的主题是 avit，可以很好的显示 git 信息</span>
/Volumes/Disk Image/cloudoffice  master ✔                                     37m
&gt; 鼠标在新一行</code></pre></div> <h3 id="插件">插件</h3> <p>oh-my-zsh 提供极为丰富的插件，在<code>~/.oh-my-zsh/plugins</code>目录下查看具体的配置。在<code>.zshrc</code>中写入<code>plugin(git autojump osx)</code>即可使用插件，下面介绍几个特别优秀的插件。</p> <h4 id="git">git</h4> <p>精简 git 命令，减少输入字符数。参见 <a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Plugin:git">Plugin:git</a>。该插件提供的快捷命令比较多，挑几个常用和好记的记忆即可，不必全记。我常用的有<code>gst</code>, <code>ggp</code>, <code>gco</code>, <code>gcm</code>, <code>gcp</code> 等。</p> <h4 id="autojump">autojump</h4> <p><a href="https://github.com/wting/autojump">autojump</a> 按照你的使用频率记录路径，使得目录的跳转更为方便。安装<code>brew install autojump</code>。如需跳转到包含 ‘foo’ 的目录，执行<code>j foo</code>，这是最基础，也是最常用的命令。除此之外，还有<code>jc</code>, <code>jo</code>, <code>jco</code>命令，查看官网文档获取更多的使用方法。</p> <h4 id="osx">osx</h4> <p>该插件增强 Mac 下的使用体验，提供了如下命令：</p> <ul> <li><code>cdf</code>: 在 Finder 中打开要 cd 的目录；</li> <li><code>quick-look</code>: 快速预览该文件，类似于在 Finder 中按下空格键；</li> <li><code>man preview</code>: 在 preview 中打开 man page；</li> <li><code>itunes</code>: 命令行操作 iTunes。</li> </ul> <div class="highlight"><pre><code class="language-bash">&gt; itunes
itunes:shift:2: <span class="nb">shift</span> count must be &lt;<span class="o">=</span> <span class="nv">$#</span>
Usage: itunes &lt;option&gt;
option:
	launch<span class="p">|</span>play<span class="p">|</span>pause<span class="p">|</span>stop<span class="p">|</span>rewind<span class="p">|</span>resume<span class="p">|</span>quit
	mute<span class="p">|</span>unmute	control volume <span class="nb">set</span>
	next<span class="p">|</span>previous	play next or previous track
	shuf<span class="p">|</span>shuffle <span class="o">[</span>on<span class="p">|</span>off<span class="p">|</span>toggle<span class="o">]</span>	Set shuffled playback. Default: toggle. Note: toggle doesn<span class="err">&#39;</span>t support the MiniPlayer.
	vol	Set the volume, takes an argument from <span class="m">0</span> to <span class="m">100</span>
	<span class="nb">help</span>	show this message and <span class="nb">exit</span></code></pre></div> <p>其他命令可查看<a href="https://github.com/robbyrussell/oh-my-zsh/blob/master/plugins/osx/osx.plugin.zsh">插件</a>。</p> <h2 id="proxychains">proxychains</h2> <p>proxychains 是命令行的科学上网工具。安装<code>brew install proxychains-ng</code>。如图所示，亚马逊 S3 存储服务和 github 并不稳定，有时候需要科学上网才能访问。</p> <div class="highlight"><pre><code class="language-bash"><span class="c1"># 原命令</span>
brew cask install xxx
<span class="c1"># 使用 proxychains</span>
proxychains4 brew cask install xxx</code></pre></div> <p><figure> <a class='post-image' rel='post-image' href='http://wulfric.qiniudn.com/proxychain.png'> <img src="http://wulfric.qiniudn.com/proxychain.png" alt="proxychains" title="proxychains" /> </a> <figcaption>proxychains</figcaption> </figure></p> <p>使用 proxychains 需要本地先开启科学上网的工具，比如 VPN/shadowsocks，然后在配置文件中添加相应的配置，其配置方法和 chrome 下的科学上网插件很相似，可以参考相关文档。</p> <div class="highlight"><pre><code class="language-bash"><span class="c1"># 在文件 ~/.proxychains/proxychains.conf 的末尾 ProxyList 部分，参照 ProxyList format Examples 添加，比如我用的是 shadowsocks，则配置是：</span>
socks5 	<span class="m">127</span>.0.0.1 <span class="m">1080</span></code></pre></div> <h2 id="其他">其他</h2> <h3 id="ag">ag</h3> <p><a href="https://github.com/ggreer/the_silver_searcher">ag</a> 是一个新的搜索工具：</p> <ul> <li>与<code>ack</code>相比，速度有了巨大的提升，这里有一个<a href="http://dongweiming.github.io/blog/archives/ack/">对比</a>；</li> <li>搜索会忽略<code>.gitignore</code>和<code>.hgignore</code>中的 pattern；</li> <li>不想搜索的文件可以把对应的 pattern 写到<code>.agignore</code>中；</li> <li>命令比<code>ack</code>短 33%，且一只手可以按全。</li> </ul> <p>最后一条虽然看似戏谑，却道出了工具的本质：哪怕是能减少输入一个字符，也是必要的进步。</p> <h3 id="htop">htop</h3> <p><a href="http://hisham.hm/htop/">htop</a> 是一款运行于 Linux 系统监控与进程管理软件，用于取代 Unix 下传统的 top。与 top 只提供最消耗资源的进程列表不同，htop 提供所有进程的列表，并且使用彩色标识出处理器、swap 和内存状态。<sup id="fnref:htop-wiki"><a href="#fn:htop-wiki" class="footnote">1</a></sup></p> <p><figure> <a class='post-image' rel='post-image' href='http://wulfric.qiniudn.com/htop.png'> <img src="http://wulfric.qiniudn.com/htop.png" alt="htop" title="htop" /> </a> <figcaption>htop</figcaption> </figure></p> <p>htop 命令优点<sup id="fnref:htop-lizhenghn"><a href="#fn:htop-lizhenghn" class="footnote">2</a></sup>:</p> <ul> <li>快速查看关键性能统计数据，如 CPU（多核布局）、内存/交换使用；</li> <li>可以横向或纵向滚动浏览进程列表，以查看所有的进程和完整的命令行；</li> <li>杀掉进程时可以直接选择而不需要输入进程号；</li> <li>通过鼠标操作条目；</li> <li>比 top 启动得更快。</li> </ul> <h3 id="ccat">ccat</h3> <p><a href="https://github.com/jingweno/ccat">ccat</a> 是上色的<code>cat</code>，在 cat 的基础上提供了语法高亮。可通过<code>brew install ccat</code>安装。目前已支持<code>ruby</code>, <code>python</code>, <code>javascript</code>, <code>java</code>, <code>c</code>, <code>go</code>。</p> <p><figure> <a class='post-image' rel='post-image' href='http://wulfric.qiniudn.com/R-ccat.png'> <img src="http://wulfric.qiniudn.com/R-ccat.png" alt="ccat" title="ccat" /> </a> <figcaption>ccat</figcaption> </figure></p> <div class="footnotes"> <ol> <li id="fn:htop-wiki"> <p><a href="https://zh.wikipedia.org/wiki/Htop">Htop - 维基百科，自由的百科全书</a>&nbsp;<a href="#fnref:htop-wiki" class="reversefootnote">&#8617;</a></p> </li> <li id="fn:htop-lizhenghn"> <p><a href="http://www.cnblogs.com/lizhenghn/p/3728610.html">Linux下超级命令htop的学习使用 - lizhenghn - 博客园</a>&nbsp;<a href="#fnref:htop-lizhenghn" class="reversefootnote">&#8617;</a></p> </li> </ol> </div> </article> <div id='additional' class='clearfix'> <div id="tags" class='pull-left'> zsh, oh-my-zsh, autojump, proxychains, ag, htop, ccat </div> <a class='pull-right' href="#comments" rel="modal:open">评论</a> </div> <div id="comments"> <!-- 多说评论框 start --> <div class="ds-thread" data-thread-key="/%E6%8A%80%E6%9C%AF/2015/08/13/zsh.html" data-title="一些命令行效率工具" data-url="http://wwulfric.github.io/%E6%8A%80%E6%9C%AF/2015/08/13/zsh.html"></div> <!-- 多说评论框 end --> <!-- 多说公共JS代码 start (一个网页只需插入一次) --> <script type="text/javascript"> var duoshuoQuery = {short_name:"storm-spirit"}; (function() { var ds = document.createElement('script'); ds.type = 'text/javascript';ds.async = true; ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js'; ds.charset = 'UTF-8'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds); })(); </script> <!-- 多说公共JS代码 end --> </div> </div> <footer> <a class="page-link" href="/about/">wulfric</a> © 2013~2014. All rights reserved. </footer> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-54608037-1', 'auto'); ga('send', 'pageview'); </script> </div> </body> </html>
