<!DOCTYPE html> <html class='borderbox'> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Mac OS 使用 jenv 管理 java 版本</title> <meta name="description" content="这是我的中文博客，记录自己在技术、生活等方面的一些感想。博客叫 Storm Spirit， 因为我特别喜欢 Dota 里蓝猫这个英雄，可惜玩得不好…… 希望自己能够通过博客，得到成长。 "> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://wwulfric.github.io/%E6%8A%80%E6%9C%AF/2017/03/07/macos-jenv.html"> <script src="/js/jquery-2.1.1.min.js"></script> <script src="/js/jquery.modal.min.js"></script> <script src="/js/main.js"></script> </head> <body> <div class='content'> <header> <a class="site-title" href="/">Storm Spirit</a> </header> <div class="post typo"> <header class="post-header clearfix"> <div class='date pull-left clearfix'> <div class='day-month pull-left'> <div class='day'>07</div> <div class='month'>MAR</div> </div> <div class='year pull-left'>2017</div> </div> <h1 class="post-title">Mac OS 使用 jenv 管理 java 版本</h1> </header> <blockquote id='by-nc-nd'> 声明: 本文采用 <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh_TW" rel="nofollow" target="_blank" title="姓名标示-非商业性-禁止改作4.0国际">CC BY-NC-ND 4.0</a> 授权。 </blockquote> <article class="post-content"> <p><a href="http://www.jenv.be/">jenv</a> 是跨平台的 java 版本管理工具。当然，pyenv 仿的 rbenv，jenv 也是仿的 rbenv，功能和用法也很类似。</p> <div class="highlight"><pre><code class="language-shell">$ brew install jenv
<span class="c1"># 添加 path</span>
$ <span class="nb">echo</span> <span class="s1">&#39;export PATH=&quot;$HOME/.jenv/bin:$PATH&quot;&#39;</span> &gt;&gt; ~/.zshrc
$ <span class="nb">echo</span> <span class="s1">&#39;eval &quot;$(jenv init -)&quot;&#39;</span> &gt;&gt; ~/.zshrc

<span class="c1"># 安装成功，添加 java 版本(需自行下载安装)</span>
$ brew tap caskroom/versions
$ brew cask install java7
$ brew cask install java8
<span class="c1"># 需要注意的是，这里仅仅安装了 java 的 pkg 文件，你还需要进入对应的目录，执行这个 pkg 文件来完成安装。</span>
$ <span class="nb">cd</span> /usr/local/Caskroom/java7/1.7.xxx
$ open xxx.pkg

<span class="c1"># 将安装好的 java 添加到 jenv，注意路径和版本可能稍有不同</span>
$ jenv add /Library/Java/JavaVirtualMachines/jdk1.8.0_66.jdk/Contents/Home/
$ jenv add /Library/Java/JavaVirtualMachines/jdk1.7.0_80.jdk/Contents/Home/</code></pre></div> <p>安装好后，大部分的使用方法都和 rbenv/pyenv 类似，无非就是 /versions/local/global 等，当然还有一些特殊的配置，比如 java 的 options：</p> <div class="highlight"><pre><code class="language-shell"><span class="c1"># 使用 1.7 版本</span>
$ jenv <span class="nb">local</span> <span class="m">1</span>.7
<span class="c1"># 设置编译参数选项</span>
$ jenv local-options <span class="s2">&quot;-Xmx512m&quot;</span>
<span class="c1"># 查看 所使用的 java 的信息</span>
$ jenv info java</code></pre></div> <p>查看版本是否更改成功：</p> <div class="highlight"><pre><code class="language-shell">$ java -version
java version <span class="s2">&quot;1.8.0_66&quot;</span>
Java<span class="o">(</span>TM<span class="o">)</span> SE Runtime Environment <span class="o">(</span>build <span class="m">1</span>.8.0_66-b17<span class="o">)</span>
Java HotSpot<span class="o">(</span>TM<span class="o">)</span> <span class="m">64</span>-Bit Server VM <span class="o">(</span>build <span class="m">25</span>.66-b17, mixed mode<span class="o">)</span>

$ jenv <span class="nb">local</span> <span class="m">1</span>.7

$ jenv info java
Jenv will <span class="nb">exec</span> : /Users/xxx/.jenv/versions/1.7/bin/java
Exported variables :
  <span class="nv">JAVA_HOME</span><span class="o">=</span>/Users/xxx/.jenv/versions/1.7

$ java -version
java version <span class="s2">&quot;1.7.0_80&quot;</span>
Java<span class="o">(</span>TM<span class="o">)</span> SE Runtime Environment <span class="o">(</span>build <span class="m">1</span>.7.0_80-b15<span class="o">)</span>
Java HotSpot<span class="o">(</span>TM<span class="o">)</span> <span class="m">64</span>-Bit Server VM <span class="o">(</span>build <span class="m">24</span>.80-b11, mixed mode<span class="o">)</span>

$ jenv which java
/Users/xxx/.jenv/versions/1.7/bin/java

$ jenv enable-plugin maven
jenv: no such <span class="nb">command</span> <span class="sb">`</span>enable-plugin<span class="err">&#39;</span></code></pre></div> <p>我们发现虽然 jenv 的 version 对了，但是 java -version 的结果还是不对，而且尝试开启 maven 插件也出错。执行<code>jenv doctor</code>查看原因：</p> <div class="highlight"><pre><code class="language-shell">$ jenv doctor
<span class="o">[</span>OK<span class="o">]</span>   	No JAVA_HOME <span class="nb">set</span>
<span class="o">[</span>ERROR<span class="o">]</span>	Java binary in path is not in the jenv shims.
<span class="o">[</span>ERROR<span class="o">]</span>	Please check your path, or try using /path/to/java/home is not a valid path to java installation.
       	PATH : ...
<span class="o">[</span>ERROR<span class="o">]</span>	Jenv is not loaded in your zsh
<span class="o">[</span>ERROR<span class="o">]</span>	To fix :       	cat <span class="nb">eval</span> <span class="s2">&quot;</span><span class="k">$(</span>jenv init -<span class="k">)</span><span class="s2">&quot;</span> &gt;&gt; /Users/xxx/.zshrc</code></pre></div> <p>原来是因为终端开了多个标签页，在另一个标签页编辑完 .zshrc 文件后直接到这个标签页执行了，应该先 source 一下：<code>source ~/.zshrc</code>。</p> <div class="highlight"><pre><code class="language-shell">$ jenv enable-plugin maven
maven plugin activated

$ jenv disable-plugin maven
maven disabled</code></pre></div> <p>成功开启。需要注意，插件的支持是全局的，和 local/shell 无关，只需要开启一次就行了。jenv 的所有插件可以查看<a href="https://github.com/gcuisinier/jenv#plugins">列表</a>。</p> </article> <div id='additional' class='clearfix'> <div id="tags" class='pull-left'> brew, jenv, rbenv, java </div> <a class='pull-right' href="#comments" rel="modal:open">评论</a> </div> <div id="comments"> <!-- 多说评论框 start --> <div class="ds-thread" data-thread-key="/%E6%8A%80%E6%9C%AF/2017/03/07/macos-jenv.html" data-title="Mac OS 使用 jenv 管理 java 版本" data-url="http://wwulfric.github.io/%E6%8A%80%E6%9C%AF/2017/03/07/macos-jenv.html"></div> <!-- 多说评论框 end --> <!-- 多说公共JS代码 start (一个网页只需插入一次) --> <script type="text/javascript"> var duoshuoQuery = {short_name:"storm-spirit"}; (function() { var ds = document.createElement('script'); ds.type = 'text/javascript';ds.async = true; ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js'; ds.charset = 'UTF-8'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds); })(); </script> <!-- 多说公共JS代码 end --> </div> </div> <footer> <a class="page-link" href="/about/">wulfric</a> © 2013~2014. All rights reserved. </footer> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-54608037-1', 'auto'); ga('send', 'pageview'); </script> </div> </body> </html>
